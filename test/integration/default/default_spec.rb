# -*- coding: utf-8 -*-

describe file '/usr/local/share/pentest-env' do
  it { should exist }
  it { should be_directory }
  it { should be_owned_by 'kitchen' }
end

describe file '/usr/local/bin/pentest-env' do
  it { should exist }
  it { should be_linked_to '/usr/local/share/pentest-env/bin/pentest-env' }
end

describe file '/root/.pentestrc' do
  it { should exist }
  it { should be_owned_by 'kitchen' }
  it { should be_grouped_into 'root' }
  its('content') { should match(/^instances:\n- kali$/) }
end

describe file '/home/kitchen/.pentestrc' do
  it { should exist }
  it { should be_owned_by 'kitchen' }
  it { should be_grouped_into 'root' }
  its('content') { should match(/^targets:\n- metasploitable3$/) }
end

%w(cookbooks .bundle .berkshelf).each do |dir|
  describe file "/usr/local/share/pentest-env/#{dir}" do
    it { should exist }
    it { should be_directory }
  end
end

%w(Gemfile.lock Berksfile.lock).each do |lockfile|
  describe file "/usr/local/share/pentest-env/#{lockfile}" do
    it { should exist }
    it { should be_file }
  end
end
