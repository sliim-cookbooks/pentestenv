# -*- coding: utf-8 -*-

describe file '/usr/local/share/pentest-env' do
  it { should exist }
  it { should be_owned_by 'root' }
end

describe file '/usr/local/bin/pentest-env' do
  it { should exist }
  it { should be_linked_to '/usr/local/share/pentest-env/bin/pentest-env' }
end

describe file '/root/.pentestrc' do
  it { should exist }
  it { should be_owned_by 'root' }
  it { should be_grouped_into 'root' }
  its('content') { should match(/^instances:\n- kali\ntargets:\n- metasploitable3$/) }
end

describe file '/home/kitchen/.pentestrc' do
  it { should exist }
  it { should be_owned_by 'root' }
  it { should be_grouped_into 'root' }
  its('content') { should match(/^targets:\n- metasploitable3$/) }
end
